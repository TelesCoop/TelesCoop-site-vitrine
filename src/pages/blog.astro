---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import BlogCard from '../components/BlogCard.astro';
import { getCollection, getEntry } from 'astro:content';

const blogCollection = await getCollection('blog', ({ data }) => !data.draft);
const categories = await getEntry('data', 'categories');

const blogData = blogCollection.map(a => ({ ...a.data, slug: a.slug, content: a.body }));
const categoriesData = categories?.data || {};

const title = 'Notre blog';
const description = 'Les articles du blog TelesCoop sur le d√©veloppement web, l\'open source et l\'√©cologie num√©rique.';
const top = 'Apprenez-en plus sur TelesCoop et nos valeurs gr√¢ce √† ces quelques articles r√©dig√©s par nous (garantie sans IA ü§ñ ).';
---

<Layout title={title} description={description}>
  <Header slot="header" />

  <div class="container mx-auto px-4 py-16 mt-16">
    <div class="text-center mb-12">
      <img
        src="/img/svg/illustration-projet.svg"
        class="md:hidden mx-auto mb-6"
        alt=""
        style="height: 120px"
      />
      <h1 class="uppercase text-4xl md:text-5xl mb-6">{title}</h1>
      <p class="text-center text-lg text-black max-w-3xl mx-auto">
        {top}
      </p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-12">
      {blogData.map((article: any) => (
        <BlogCard article={article} categories={categoriesData} />
      ))}
    </div>
  </div>

  <Footer slot="footer" pageWeight={115} />
</Layout>
